# üöÄ –ü–ª–∞–Ω —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ Safe –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

## üéØ –¶–µ–ª—å
–£–ø—Ä–æ—Å—Ç–∏—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –¥–æ 2 –æ—Å–Ω–æ–≤–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤ –±–µ–∑ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞:
- `@onchain.ts` - –≤—Å–µ –±–ª–æ–∫—á–µ–π–Ω –æ–ø–µ—Ä–∞—Ü–∏–∏ 
- `@offchain.ts` - –ø–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ–ø–æ–∑–∞–ª–æ–≤ –∏–∑ STS

## üìã –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
```
safe-manager.ts (1120 —Å—Ç—Ä–æ–∫) ‚Üê –£–î–ê–õ–ò–¢–¨
safe-common.ts (150 —Å—Ç—Ä–æ–∫)   ‚Üê –ß–ê–°–¢–ò–ß–ù–û –£–î–ê–õ–ò–¢–¨ 
safe-onchain.ts (992 —Å—Ç—Ä–æ–∫–∏) ‚Üê –†–ê–°–®–ò–†–ò–¢–¨
safe-offchain.ts (937 —Å—Ç—Ä–æ–∫) ‚Üê –£–ü–†–û–°–¢–ò–¢–¨
LocalTransactionStorage       ‚Üê –£–î–ê–õ–ò–¢–¨
```

## üéØ –¶–µ–ª–µ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### `SafeOnChain` (onchain.ts) - –ì–ª–∞–≤–Ω—ã–π –∫–ª–∞—Å—Å
**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏:**
1. ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Safe
2. ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ö—ç—à–∞ –æ–ø–µ—Ä–∞—Ü–∏–π 
3. ‚úÖ Approve hash –≤ –±–ª–æ–∫—á–µ–π–Ω–µ
4. ‚úÖ Execute —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
5. üÜï –í—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π API –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ (–∏–∑ SafeManager)

### `SafeOffChain` (offchain.ts) - –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–π –∫–ª–∞—Å—Å  
**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏:**
1. ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ–ø–æ–∑–∞–ª–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ STS
2. ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–ø–æ–∑–∞–ª–æ–≤
3. ‚ùå ~~LocalTransactionStorage~~ - —É–±–∏—Ä–∞–µ–º
4. ‚ùå ~~–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π~~ - —É–±–∏—Ä–∞–µ–º

### `safe-common.ts` - –¢–æ–ª—å–∫–æ —É—Ç–∏–ª–∏—Ç—ã
**–û—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ:**
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∫–æ—à–µ–ª—å–∫—É
- –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–¥—Ä–µ—Å–æ–≤/–∑–Ω–∞—á–µ–Ω–∏–π
- –°–µ—Ç–µ–≤—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

## üìù –ü–æ—à–∞–≥–æ–≤—ã–π –ø–ª–∞–Ω

### –®–∞–≥ 1: –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π ‚úÖ
- [x] –ù–∞–π—Ç–∏ –≤—Å–µ –º–µ—Å—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è SafeManager
- [x] –ù–∞–π—Ç–∏ –≤—Å–µ –º–µ—Å—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è LocalTransactionStorage
- [x] –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∫–∏–µ –º–µ—Ç–æ–¥—ã –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –≤ SafeOnChain

### –®–∞–≥ 2: –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ SafeOnChain ‚úÖ
- [x] –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ –≤—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã –∏–∑ SafeManager
- [x] –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥—ã –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ workflow: propose ‚Üí approve ‚Üí execute
- [x] –£–±—Ä–∞—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç LocalTransactionStorage

### –®–∞–≥ 3: –£–ø—Ä–æ—â–µ–Ω–∏–µ SafeOffChain ‚úÖ
- [x] –£–±—Ä–∞—Ç—å LocalTransactionStorage
- [x] –û—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ STS –∏ –ø—Ä–æ–ø–æ–∑–∞–ª—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- [x] –£–ø—Ä–æ—Å—Ç–∏—Ç—å fallback –ª–æ–≥–∏–∫—É

### –®–∞–≥ 4: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ ‚úÖ
- [x] –ó–∞–º–µ–Ω–∏—Ç—å SafeManager –Ω–∞ –ø—Ä—è–º–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ SafeOnChain
- [x] –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç UserProposals
- [x] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤–µ—Å—å workflow

### –®–∞–≥ 5: –û—á–∏—Å—Ç–∫–∞ ‚úÖ
- [x] –£–¥–∞–ª–∏—Ç—å safe-manager.ts
- [x] –£–¥–∞–ª–∏—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —á–∞—Å—Ç–∏ safe-common.ts
- [x] –£–¥–∞–ª–∏—Ç—å LocalTransactionStorage

## üîÑ Workflow –ø–æ—Å–ª–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞

```typescript
// 1. –°–æ–∑–¥–∞–Ω–∏–µ/–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ Safe
const safeOnChain = new SafeOnChain(signer)
await safeOnChain.createSafe(form) // –∏–ª–∏ connectToSafe(form)

// 2. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ö—ç—à–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏
const result = await safeOnChain.createTransactionHash(params)

// 3. Approve hash –≤ –±–ª–æ–∫—á–µ–π–Ω–µ
await safeOnChain.approveTransactionHash(result.safeTxHash)

// 4. Execute —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
await safeOnChain.executeWithApprovals(result.safeTxHash)

// –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ: –ø–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ–ø–æ–∑–∞–ª–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
const safeOffChain = new SafeOffChain()
const proposals = await safeOffChain.getUserProposals({userAddress})
```

## ‚ö†Ô∏è –†–∏—Å–∫–∏ –∏ –≤–æ–ø—Ä–æ—Å—ã

1. **–ß—Ç–æ –¥–µ–ª–∞—Ç—å —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π?**
   - Approve hash –≤ –±–ª–æ–∫—á–µ–π–Ω–µ –∑–∞–º–µ–Ω—è–µ—Ç LocalStorage
   - –ù—É–∂–Ω–æ –ª–∏ –≤—Ä–µ–º–µ–Ω–Ω–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –ø–∞–º—è—Ç–∏?

2. **–ö–∞–∫ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å fallback –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ STS?**
   - –¢–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è –ø—Ä–æ–ø–æ–∑–∞–ª–æ–≤
   - –û—Å–Ω–æ–≤–Ω–æ–π workflow —á–µ—Ä–µ–∑ –±–ª–æ–∫—á–µ–π–Ω

3. **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**
   - –§—Ä–æ–Ω—Ç–µ–Ω–¥ –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å
   - –í—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ SafeManager

## üöÄ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø–æ—Å–ª–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞

‚úÖ **–ü—Ä–æ—Å—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:** —Ç–æ–ª—å–∫–æ 2 –æ—Å–Ω–æ–≤–Ω—ã—Ö –∫–ª–∞—Å—Å–∞  
‚úÖ **–ú–µ–Ω—å—à–µ –∫–æ–¥–∞:** —É–±–∏—Ä–∞–µ–º ~1200 —Å—Ç—Ä–æ–∫  
‚úÖ **–ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å:** approve hash –≤ –±–ª–æ–∫—á–µ–π–Ω–µ –≤–º–µ—Å—Ç–æ localStorage  
‚úÖ **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** –º–µ–Ω—å—à–µ —Å–ª–æ—ë–≤ –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏  
‚úÖ **–ü–æ–¥–¥–µ—Ä–∂–∫–∞:** –ø—Ä–æ—â–µ –ø–æ–Ω–∏–º–∞—Ç—å –∏ –∏–∑–º–µ–Ω—è—Ç—å  

---

## üìã Status: ‚úÖ –†–ï–§–ê–ö–¢–û–†–ò–ù–ì –ó–ê–í–ï–†–®–ï–ù –£–°–ü–ï–®–ù–û!

**üéâ –†–ï–ó–£–õ–¨–¢–ê–¢:**
- ‚ùå **50 –æ—à–∏–±–æ–∫ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏** ‚Üí ‚úÖ **0 –æ—à–∏–±–æ–∫**
- ‚ùå **3 —Ñ–∞–π–ª–∞ (safe-manager.ts + LocalStorage)** ‚Üí ‚úÖ **2 —Ñ–∞–π–ª–∞ (SafeOnChain + SafeOffChain)**
- ‚ùå **–°–ª–æ–∂–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å localStorage** ‚Üí ‚úÖ **–ü—Ä–æ—Å—Ç–æ–π workflow —Å approve hash**
- ‚ùå **100+ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π LocalStorage** ‚Üí ‚úÖ **–ü–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª–µ–Ω**

**üöÄ –ù–û–í–´–ô WORKFLOW:**
1. `SafeOnChain` - —Å–æ–∑–¥–∞–Ω–∏–µ/–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ + –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ö—ç—à–∞ + approve + execute
2. `SafeOffChain` - –ø–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ–ø–æ–∑–∞–ª–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ STS
3. –ü—Ä–æ—Å—Ç–æ–π API –±–µ–∑ localStorage –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
